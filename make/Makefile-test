test: build/test/test_all
	$(GTESTER) -o build/test/test_report.xml $<
	sed -i 's#<gtester>#<gtester>\n<info>\n<package>semaphore</package><version>0</version><revision>0</revision>\n</info>#' build/test/test_report.xml
	$(GTESTER_REPORT) build/test/test_report.xml > build/test/test_report.html

$(eval $(call TEST_EXE,test_all,test/test_all test/test_action_list test/test_heap_entry_array test/test_timer main/sem_heap main/sem_timer main/sem_error))
$(eval $(call TEST_OBJ,test_all))
$(eval $(call TEST_OBJ_H,test_action_list))
$(eval $(call TEST_OBJ_H,test_heap_entry_array))
$(eval $(call TEST_OBJ_H,test_timer))

$(eval $(call TEST_DEP_OBJ,test_all,test/test_timer))
$(eval $(call TEST_DEP_OBJ,test_heap_entry_array,main/sem_error main/sem_heap))
$(eval $(call TEST_DEP_OBJ,test_timer,main/sem_timer))

build/test:
	mkdir -p $@
