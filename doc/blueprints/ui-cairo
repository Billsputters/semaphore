Semaphore Blueprint: Cairo UI
=============================
James Shaw <js102@zepler.net>

The cairo UI renders all game objects as vector graphics.

Passenger stations and sidings
------------------------------
These station types are rendered with a coloured background on their platform tiles.  The shape of the station is described as a set of outlines that are filled with an even-odd winding rule.  An 'outline' is an ordered list of 'vertices' that forms a single closed shape.

The following algorithm constructs the set of outlines by examining all the platform tiles in a station.  The principle is to find pairs of adjacent tiles where only one is a platform tile.  A 'segment' is created that represents the boundary line between the two tiles.  Segments are horizontal or vertical lines that are one tile in length.  Segments are joined together to make an outline.  Collinear vertexes are removed in order to construct the simplest outline.  The final segment that links the outline's start and end points closes the outline.

................................................................................
For every platform tile in the station
	Test adjacent tiles to the N, S, E and W
	For each of these tiles that are not platform tiles in the station, create a segment that defines the boundary between the current tile and the adjacent tile
		Try to extend an existing open outline with this segment
		If that fails, create a new open outline containing this segment

An outline can be extended with a segment if either the segment's start or end vertex is the same as the outline's first or last vertex
	Take the opposite vertex, 'v', of the segment to that which matches the outline
	If 'v' matches the vertex at the opposite end of the outline, then close the outline
	Otherwise
		If 'v', the outline's existing start/end vertex, and the outline's penultimate vertex are collinear
			Replace the existing start/end vertex with 'v'
		Otherwise
			Prepend/append 'v' to the outline 
................................................................................

// vim: set syntax=asciidoc:
